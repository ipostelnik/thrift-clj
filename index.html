<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>thrift-clj by xsc</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>thrift-clj</h1>
        <p>Thrift and Clojure!</p>

        <p class="view"><a href="https://github.com/xsc/thrift-clj">View the Project on GitHub <small>xsc/thrift-clj</small></a></p>


        <ul>
          <li><a href="https://github.com/xsc/thrift-clj/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/xsc/thrift-clj/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/xsc/thrift-clj">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h2>
<a name="using-thrift-from-clojure-as-if-it-was-clojure" class="anchor" href="#using-thrift-from-clojure-as-if-it-was-clojure"><span class="octicon octicon-link"></span></a>Using Thrift from Clojure as if it was Clojure!</h2>

<p><a href="http://thrift.apache.org/">Apache Thrift</a> is an awesome (and terribly documented) framework for server/client interaction. It let's you define types and service functions, creates whole servers and the respective clients in the blink of an eye. However, there currently is no Thrift IDL to Clojure compiler available.</p>

<p><strong>thrift-clj</strong> fills this gap by loading the Java classes generated by the Thrift compiler, making them accessible using plain-and-simple Clojure records and functions.</p>

<h2>
<a name="use-it" class="anchor" href="#use-it"><span class="octicon octicon-link"></span></a>Use it!</h2>

<p><strong>Leiningen</strong></p>

<div class="highlight highlight-clojure"><pre><span class="p">[</span><span class="nv">thrift-clj</span> <span class="s">"0.2.1"</span><span class="p">]</span>
</pre></div>

<p><strong>Clojure</strong></p>

<div class="highlight highlight-clojure"><pre><span class="p">(</span><span class="nf">require</span> <span class="o">'</span><span class="p">[</span><span class="nv">thrift-clj.core</span> <span class="ss">:as</span> <span class="nv">thrift</span><span class="p">])</span>
</pre></div>

<h3>
<a name="types" class="anchor" href="#types"><span class="octicon octicon-link"></span></a>Types</h3>

<div class="highlight highlight-clojure"><pre><span class="p">(</span><span class="nf">thrift/import</span> 
  <span class="p">(</span><span class="ss">:types</span> <span class="p">[</span><span class="nv">test.types</span> <span class="nv">Point</span><span class="p">]))</span>

<span class="p">(</span><span class="k">def </span><span class="nv">p</span> <span class="p">(</span><span class="nf">Point.</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">))</span>
<span class="p">(</span><span class="nb">println </span><span class="s">"Point:"</span> <span class="p">(</span><span class="nb">str </span><span class="s">"("</span> <span class="p">(</span><span class="ss">:x</span> <span class="nv">p</span><span class="p">)</span> <span class="s">","</span> <span class="p">(</span><span class="ss">:y</span> <span class="nv">p</span><span class="p">)</span> <span class="s">")"</span><span class="p">))</span>
</pre></div>

<h3>
<a name="clients" class="anchor" href="#clients"><span class="octicon octicon-link"></span></a>Clients</h3>

<div class="highlight highlight-clojure"><pre><span class="p">(</span><span class="nf">thrift/import</span>
  <span class="p">(</span><span class="ss">:types</span> <span class="p">[</span><span class="nv">test.types</span> <span class="nv">Point</span><span class="p">])</span>
  <span class="p">(</span><span class="ss">:clients</span> <span class="p">[</span><span class="nv">test.service.Painter</span> <span class="ss">:as</span> <span class="nv">P</span><span class="p">]))</span>

<span class="p">(</span><span class="nb">with-open </span><span class="p">[</span><span class="nv">c</span> <span class="p">(</span><span class="nf">thrift/connect!</span> <span class="nv">P</span> <span class="s">"localhost:1234"</span> <span class="ss">:protocol</span> <span class="ss">:json</span><span class="p">)]</span>
  <span class="p">(</span><span class="nf">P/drawCircle</span> <span class="nv">c</span> <span class="p">(</span><span class="nf">Point.</span> <span class="mi">10</span> <span class="mi">10</span><span class="p">)</span> <span class="mi">5</span><span class="p">))</span>
</pre></div>

<h3>
<a name="services" class="anchor" href="#services"><span class="octicon octicon-link"></span></a>Services</h3>

<div class="highlight highlight-clojure"><pre><span class="p">(</span><span class="nf">thrift/import</span>
  <span class="p">(</span><span class="ss">:services</span> <span class="p">[</span><span class="nv">test.service.Painter</span> <span class="ss">:as</span> <span class="nv">P</span><span class="p">]))</span>

<span class="p">(</span><span class="nf">thrift/defservice</span> <span class="nv">painter</span> <span class="nv">P</span>
  <span class="p">(</span><span class="nf">drawCircle</span> <span class="p">[{</span><span class="ss">:keys</span><span class="p">[</span><span class="nv">x</span> <span class="nv">y</span><span class="p">]}</span> <span class="nv">radius</span><span class="p">]</span>
    <span class="nv">...</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">drawSquare</span> <span class="p">[{</span><span class="ss">:keys</span><span class="p">[</span><span class="nv">x</span> <span class="nv">y</span><span class="p">]}</span> <span class="nv">edge</span><span class="p">]</span>
    <span class="nv">...</span><span class="p">)</span>
  <span class="nv">...</span><span class="p">)</span>

<span class="p">(</span><span class="nf">thrift/serve-and-block!</span>
  <span class="p">(</span><span class="nf">thrift/multi-threaded-server</span> <span class="nv">painter</span> <span class="mi">1234</span> <span class="ss">:protocol</span> <span class="ss">:json</span><span class="p">))</span>
</pre></div>

<p>Have a look at the <a href="https://github.com/xsc/thrift-clj/wiki">Wiki</a> for detailed usage instructions.</p>

<h2>
<a name="automatic-thrift-compilation" class="anchor" href="#automatic-thrift-compilation"><span class="octicon octicon-link"></span></a>Automatic Thrift Compilation</h2>

<p>If you want to have your Thrift IDL files compiled to Java automatically, have a look at <a href="https://github.com/xsc/lein-thriftc">lein-thriftc</a>!</p>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/xsc">xsc</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-43025585-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>